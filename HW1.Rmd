---
title: "HW1"
author: "SHUYUAN"
date: "9/19/2021"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library("readxl")
my_data <- read_excel("C:/Users/Megan Jia/Documents/WI20.xlsx")
head(my_data)

```

```{r}
my_data['YEAR_BUILT_027']
# Build year
```
```{r}
my_data['STRUCTURE_NUMBER_008']
# Bridge ID

```
```{r}

my_data['COUNTY_CODE_003']

# OPERATING_RATING_064
# fips codes

```
```{r}
# Conditional Ratings
# Items 58 through 62 - Indicate the Condition Ratings
#DECK_COND_058
#SUPERSTRUCTURE_COND_059
#SUBSTRUCTURE_COND_060
```


```{r}
#DETOUR_KILOS_019
```


```{r}
df <- data.frame (col_1 = my_data['STRUCTURE_NUMBER_008'],
                  col_2 = my_data['YEAR_BUILT_027'],
                  col_3 = my_data['COUNTY_CODE_003'],
                  col_4 = my_data['DECK_COND_058'],
                  col_5 = my_data['SUPERSTRUCTURE_COND_059'],
                  col_6 = my_data['SUBSTRUCTURE_COND_060'],
                  col_7 = my_data['OPERATING_RATING_064'])

colnames(df) <- c('Bridge_ID','Built_Year','County_Code','Deck_Cond',
                  'Superstructure_Cond','Substructure_Cond','Operating_Rating')

write.csv(df,'WI_Bridge_data.csv')

```

```{r}
data = read.csv('WI_Bridge_data.csv')
```

```{r}
plot(data$Built_Year,data$Operating_Rating,xlab='Built Year',ylab='Operating Rating')
```
```{r}
library(ggplot2)
ggplot(data, aes(x=Built_Year, y=Operating_Rating)) + geom_point(color='orange')
```

```{r}
# 'Superstructure_Cond','Substructure_Cond','Operating_Rating'
model=lm(data$Operating_Rating ~ data$Superstructure_Cond+data$Substructure_Cond+data$Deck_Cond+data$Built_Year)
model

```

